@page
@model PRN232_FA25_Assignment_G7.RazorPages.Pages.Admin.Reports.IndexModel
@{
    ViewData["Title"] = "Reports & Export";
}

<h3 style="color: #2d3748; margin-bottom: 24px;">Reports & Export</h3>

<div style="background: white; padding: 30px; border-radius: 8px; margin-bottom: 20px;">
    <h4 style="color: #2d3748; margin-bottom: 16px;">üìä Export Exam Results</h4>
    <p style="color: #718096; margin-bottom: 20px;">Select an exam to export its results to Excel format.</p>

    <form method="post" asp-page-handler="Export" style="max-width: 600px;">
        <div class="form-group">
            <label for="examId">Select Exam</label>
            <select name="examId" id="examId" asp-items="Model.ExamSelectList" class="form-control" required>
                <option value="">-- Select an Exam --</option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary">
            üì• Export to Excel
        </button>
    </form>
</div>

@if (Model.Exams.Count > 0)
{
    <div style="background: white; padding: 30px; border-radius: 8px;">
        <h4 style="color: #2d3748; margin-bottom: 16px;">Recent Exams</h4>
        <table>
            <thead>
                <tr>
                    <th>Exam Name</th>
                    <th>Subject</th>
                    <th>Semester</th>
                    <th>Exam Date</th>
                    <th style="width: 150px; text-align: center;">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var exam in Model.Exams.Take(10))
                {
                    <tr>
                        <td><strong>@exam.Name</strong></td>
                        <td>@exam.SubjectName</td>
                        <td>@exam.SemesterName</td>
                        <td>@exam.ExamDate.ToString("MMM dd, yyyy")</td>
                        <td style="text-align: center;">
                            <form method="post" asp-page-handler="Export" style="display: inline;">
                                <input type="hidden" name="examId" value="@exam.Id" />
                                <button type="submit" class="btn btn-secondary" style="padding: 6px 12px;">
                                    Export
                                </button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div style="text-align: center; padding: 40px; color: #718096;">
        <div style="font-size: 48px; margin-bottom: 16px;">üìä</div>
        <p>No exams available for export.</p>
    </div>
}

<div style="margin-top: 30px; background: #e6f7ff; padding: 20px; border-radius: 8px; border-left: 4px solid #1890ff;">
    <h4 style="color: #0050b3; margin-bottom: 12px;">‚ÑπÔ∏è Export Features</h4>
    <ul style="color: #0050b3; line-height: 1.8; margin: 0;">
        <li>Exported files include student codes, scores, and violation details</li>
        <li>Zero-score cases are highlighted with reasons</li>
        <li>Export format: Microsoft Excel (.xlsx)</li>
        <li>File naming convention: Exam_Results_[ExamId]_[Date].xlsx</li>
    </ul>
</div>
